# Requirements
## Github rest API perms
- "Contents" repository permissions (read)

# Development
1. create logic app with github rest token in Authorization headers of http methods
1. deploy function app on flex consumption, linux, python 3.11 with vscode function app extension defaults
1. switch from storage v1 to v2 (non-essential but easier to work with)
1. enable anonymous access and set anonymous access level of "api-gen" container (generated by api generator) to Container
1. assign storage blob contributor to managed identity of function app
1. copy function URL, paste in logic app in the Uri field of the "sendToApiGenerator" step
1. merge a PR in IAC -> logic app triggers -> function app triggers 

# TODO:
- [ ] IAC everything
    - [ ] use app settings and IAC outputs for repo urls and connection strings and whatnot
    - [ ] API management
        - [ ] Proper API versioning
        - [ ] API endpoint authorization
- [ ] secrets management
- [ ] retry logic
- [ ] load balancing/queueing
- [ ] docs
- [ ] deprecation
- [ ] specs["properties"][schemaName] = spec really needs to handle duplicate keys or variables will overwrite each other

# Notes
some incompatibility with oryx (build system used in python function apps) and linux flex consumption means the default CICD provided by azure doesnt work


{"openapi": "3.0.0", "info": {"title": "Request Subscription API", "version": "versioning-not-implemented"}, "paths": {"/requestSubscription": {"post": {"summary": "Request a subscription", "requestBody": {"content": {"application/json": {"schema": {"modules_subscription": {"type": "object", "properties": {"location_short": {"type": "string", "description": "The Azure region short name"}}}}}}}, "responses": {"201": {"description": "Subscription requested successfully"}}}}}}

 One or more fields contain incorrect values:

    Parsing error(s): modules_subscription is not a valid property at #/paths/~1requestSubscription/post/requestBody/content/application~1json/schema []
    Parsing error(s): The input OpenAPI file is not valid for the OpenAPI specification https://github.com/OAI/OpenAPI-Specification/blob/master/versions/3.0.1.md (schema https://github.com/OAI/OpenAPI-Specification/blob/master/schemas/v3.0/schema.yaml).

